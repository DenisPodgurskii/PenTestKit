import { test, expect } from '../fixtures/fixtures.ts';


test('inital login test', async ({ page,extensionId }) => {

    await page.goto('https://demo.testfire.net/');
    await page.waitForTimeout(2000);
    const extension = await page.goto(`chrome-extension://${extensionId}/ptk/browser/rattacker.html`);
    await page.waitForTimeout(2000);
    const RAttacker = await page.getByText('Scan in runtime', { exact: true }).click();
    await page.waitForTimeout(2000);
    await page.getByText('Run scan', { exact: true }).click();
    await page.waitForTimeout(2000);
    await page.goto('https://demo.testfire.net/');
    await page.waitForTimeout(2000);
    await page.waitForTimeout(1000);
    await page.getByRole('link', { name: 'Sign In' }).click();
    await page.locator('#uid').click();
    await page.locator('#uid').fill('admin');
    await page.locator('#uid').press('Tab');
    await page.locator('#passw').fill('admin');
    await page.getByRole('button', { name: 'Login' }).click();
    await page.getByRole('link', { name: 'Transfer Funds' }).click();
    await page.locator('#toAccount').selectOption('800001');
    await page.locator('#transferAmount').click();
    await page.locator('#transferAmount').fill('1');
    await page.getByRole('button', { name: 'Transfer Money' }).click();
    await page.goto(`chrome-extension://${extensionId}/ptk/browser/rattacker.html`);
    await page.waitForTimeout(5000);
    const highCount = await page.locator('#high_count').innerText();
    console.log("high count is " + highCount)
    const mediumCount = await page.locator('#medium_count').innerText();
    console.log("medium count is " + mediumCount)
    const lowCount = await page.locator('#low_count').innerText();
    console.log("low count is " + lowCount)
    await page.waitForTimeout(15000);
});
