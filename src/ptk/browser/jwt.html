<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" />
    <meta content="width=device-width, initial-scale=1, maximum-scale=2, user-scalable=no" name="viewport" />
    <meta content="Penetration Testing Kit - cross-browser extension for penetration testing" name="description" />
    <meta content="Penetration Testing Kit, request builder, traffic recording, macro recording" name="keywords" />
    <meta content="PPType" name="author" />
    <meta content="#ffffff" name="theme-color" />
    <title>OWASP Penetration Testing Kit - JWT Inspector</title>

    <script src="../packages/browser-polyfill/browser-polyfill.min.js"></script>
    <script src="../packages/jquery/jquery.min.js"></script>
    <script src="../packages/jquery/jquery.dataTables.min.js"></script>

    <link rel="stylesheet" href="../packages/semantic-ui/semantic.min.css" type="text/css" />
    <script src="../packages/semantic-ui/semantic.min.js"></script>

    <link rel="stylesheet" href="../packages/codemirror/codemirror.css" type="text/css" />
    <link rel="stylesheet" href="../packages/codemirror/addon/fold/foldgutter.css" type="text/css" />
    <script src="../packages/codemirror/codemirror.js"></script>
    <script src="../packages/codemirror/mode/javascript/javascript.js"></script>
    <script src="../packages/codemirror/addon/fold/foldcode.js"></script>
    <script src="../packages/codemirror/addon/fold/foldgutter.js"></script>
    <script src="../packages/codemirror/addon/fold/brace-fold.js"></script>
    <script src="../packages/codemirror/addon/fold/xml-fold.js"></script>
    <script src="../packages/codemirror/addon/fold/indent-fold.js"></script>
    <script src="../packages/codemirror/addon/fold/markdown-fold.js"></script>
    <script src="../packages/codemirror/addon/fold/comment-fold.js"></script>


    <script src="../packages/codemirror/addon/search/searchcursor.js"></script>
    <script src="../packages/codemirror/addon/selection/mark-selection.js"></script>

    <link rel="stylesheet" href="assets/css/default.css" type="text/css" />
    <script src="assets/js/menu.js"></script>
    <script type="module" src="assets/js/jwt.js"></script>
    <style>
        #rawToken::placeholder {
            font-size: 16px;

        }

        .algorithm-select>.menu.transition.visible {
            min-height: 445px;
        }

        .algorithm-select-keys-dlg>.menu.transition.visible {
            min-height: 355px;
        }

        .dropdown.algorithm-select.selection {
            z-index: 1;
        }

        #generate_keys_dlg_form .prompt.label {
            z-index: 1;
        }

        #rawToken+.CodeMirror {
            font-size: 1.1em;
            font-weight: 300;
            min-height: 350px;
            height: 50vh !important;
        }

        .CodeMirror-wrap {
            height: 100% !important;
        }


        .CodeMirror-vscrollbar {
            width: 0px;
        }

        .CodeMirror-hscrollbar {
            height: 0px;
        }

        .styled-header {
            color: deeppink;
        }

        .styled-payload {
            color: darkviolet;
        }

        .styled-signature {
            color: mediumblue;
        }

        .dropdown.source,
        .dropdown.source>.menu>.item,
        .dropdown.algorithm-select {
            font-size: 14px !important;
        }

        .dropdown.source {
            width: calc(100% - 90px) !important;
        }

        /* .ui.large.fluid.dropdown.source.selection {
            width: calc(100% - 90px) !important;
        } */
    </style>
</head>

<body>
    <div id="mainMenuWrapper">

        <div class="ui segment clearing info_tab">
            <div style="padding-top: 5px; padding-right: 2px;">
                <div id="dashboard_message_text" class="ui left floated header short_message_text"
                    style="width: calc(100vw - 216px);margin-bottom: 0px !important">JWT Inspector</div>

                <div class="ui right floated header icons"
                    style="margin-left: 0px !important;margin-bottom: 0px !important">
                    <div class="ui mini icon button item clean"><i class="trash all alternate large icon resetall"
                            title="Reset all"></i>
                    </div>
                </div>

                <!-- <div class="ui small secondary top right pointing  dropdown icon button">
                    Keys
                    <i class="dropdown icon"></i>
                    <div class="menu">
                        <a class="item" href="#" id="generate_keys">Generate key pair</a>
                        <a class="item" href="#" id="pem_jwk_convertor">PEM &lt; - &gt; JWK convertor</a>
                    </div>
                </div>

                <div class="ui small secondary top right pointing  dropdown icon button">
                    Attacks
                    <i class="dropdown icon"></i>
                    <div class="menu">
                        <a class="item" href="#" id="generate_attacks_hs">Algorithm confusion</a>
                    </div>
                </div> -->


            </div>

        </div>


        <!-- <div class="ui segment clearing info_tab">

            <div id="dashboard_message_text" class="ui left floated header short_message_text"
                style="width: calc(100vw - 152px);">JWT Inspector</div>
            <div class="ui small secondary floating dropdown icon button">
                Attacks
                <i class="dropdown icon"></i>
                <div class="menu">
                    <a class="item" href="#" id="generate_attacks_hs">Key confusion</a>
                </div>
            </div>



            <div class="ui mini icon button item clean"><i class="trash all alternate large icon resetall"
                    title="Reset all"></i>
            </div>
        </div> -->







    </div>


    <div id="pagecontent" style="padding-top:80px; ">
        <div id="main">


            <form class="ui tiny form controls" id="jwt_form">
                <div class="ui padded height grid" style="height: 100%;">
                    <div class="eight wide column" style="padding:0px 1px 1px 1px;">
                        <div class="field" style="margin: 0px;padding: 0px;">
                            <div class="ui large secondary label" style="width: 100%;">Source</div>

                            <select id="source" name="source" class="ui large fluid dropdown source"
                                style="font-size: 14px;">
                                <option name="source" value="none" data-value="none" selected="">None</option>
                            </select>

                            <textarea id="rawToken" name="rawToken" class="ui small input decoderTextArea" rows="25"
                                placeholder="Text to decode"></textarea>
                            <div class="ui primary right floated top pointing small icon dropdown button updatein">
                                Update in<i class="dropdown icon" style="padding-left: 5px;"></i>
                                <div class="menu" style="width: 120px;top: 25px;">
                                    <a class="item" href="#" id="this_source_upd">This source</a>

                                    <a class="item" href="#" id="all_sources_upd">All sources</a>
                                </div>

                            </div>


                        </div>
                        <div class="field" style="position: fixed;height: 60px;bottom: 1px !important; width: 50%;">
                            <div class="ui message" id="signature_msg_wrapper"
                                style="margin-right: 3px;height: 99%;margin-left: -2px;">
                                <div class="header" id="signature_msg"></div>
                            </div>

                        </div>
                    </div>
                    <div class="eight wide column" style="padding:0px 1px 1px 1px; ">
                        <div class="field">
                            <div class="ui large secondary label" style="width: 100%;">Algorithm</div>
                            <select id="algorithm-select" name="algorithm-select"
                                class="ui small fluid scrolling dropdown algorithm-select" style="z-index: 2;">
                                <option value="none" selected="">None</option>
                                <option value="HS256" data-value="HMACSHA256">HS256
                                </option>
                                <option value="HS384" data-value="HMACSHA384">HS384
                                </option>
                                <option value="HS512" data-value="HMACSHA512">HS512
                                </option>
                                <option value="RS256" data-value="RSASHA256">RS256
                                </option>
                                <option value="RS384" data-value="RSASHA384">RS384
                                </option>
                                <option value="RS512" data-value="RSASHA512">RS512
                                </option>
                                <option value="ES256" data-value="ECDSASHA256">ES256
                                </option>
                                <option value="ES384" data-value="ECDSASHA384">ES384
                                </option>
                                <option value="ES512" data-value="ECDSASHA512">ES512
                                </option>
                                <option value="PS256" data-value="RSAPSSSHA256">PS256
                                </option>
                                <option value="PS384" data-value="RSAPSSSHA384">PS384
                                </option>
                                <option value="PS512" data-value="RSAPSSSHA512">PS512
                                </option>
                            </select>
                        </div>
                        <div class="field">
                            <div class="ui large label" style="width: 100%;">Header</div>
                            <div class="ui segment" style="padding: 0px;margin: 0px; height: 20vh;">
                                <textarea id="encodeHeader" name="encodeHeader" class="ui medium input" rows="25"
                                    placeholder="Header to encode"></textarea>
                            </div>
                        </div>


                        <div class="field" style="overflow: scroll;padding-bottom: 30px;">
                            <div class="ui large label" style="width: 100%;position: fixed;">Payload</div>
                            <div class="ui segment"
                                style="padding:  0px 0px 15vh 0px; margin: 28px 0px 5vh 0px; position: fixed;width: 100%;height: 25vh;overflow-y: scroll;">
                                <textarea id="encodePayload" name="encodePayload" class="ui small input"
                                    placeholder="Payload to encode" rows="25"></textarea>
                            </div>
                        </div>

                        <div class="field" style="position: fixed;height: 25%;bottom: 1px !important; width: 100%;">
                            <div class="ui large label" style="width: 100%;">Signature</div>
                            <div class="ui segment" style="padding: 0px; margin-top: -1px; width: 50%;height: 22vh;">
                                <div id="none_alg" class="ui segment"
                                    style="width: 100%;height: 100%;margin: 0px; display: none;">
                                    None
                                </div>
                                <div id="alg_secret_wrapper" class="ui segment alg_wrapper"
                                    style="width: 100%;height: 100%;margin: 0px; display: none;">

                                    <div>
                                        <span id="secret_method" style="font-weight: bold;">HMACSHA256</span><span
                                            style="font-size: 20px;">(</span>
                                        base64UrlEncode(header) + "." +
                                        base64UrlEncode(payload)<span style="font-size: 20px;">,</span>&nbsp;

                                        <!-- <input
                                            type="text" value="your-secret-here" id="alg_secret" name="alg_secret"
                                            class="alg_input"
                                            style="height: 10px; width: 150px; border: solid 1px black; margin-top: 2px;"> -->

                                        <textarea type="text" id="alg_secret" name="alg_secret"
                                            class="alg_input textarea"
                                            style="height: 94%; border: solid 1px black;font-size: 0.8em; width: 97%;"
                                            placeholder="your-secret-here" spellcheck="false"
                                            rows="2">your-secret-here</textarea>
                                        <span style="font-size: 20px;bottom: -10px;position: relative;">)</span>

                                    </div>
                                </div>
                                <div id="key_alg_wrapper" class="ui segment alg_wrapper"
                                    style="width: 100%;height: 100%;margin: 0px;display: none;">
                                    <!-- <div class="ui vertical animated tiny secondary button" tabindex="0"
                                        style="position: absolute; top: 0px; right: -3px;width: 50px;"
                                        id="generate_keys">
                                        <div class="hidden content">Keys</div>
                                        <div class="visible content">
                                            <i class="key icon"></i>
                                        </div>
                                    </div> -->
                                    <div style="position: relative;    height: 100%;">
                                        <span id="key_method" style="font-weight: bold;">RSASHA256</span> <span
                                            style="font-size: 20px;">(</span>
                                        base64UrlEncode(header) + "." +
                                        base64UrlEncode(payload)<span style="font-size: 20px;">,</span>
                                        <div style="height: 100%; width: 100%;  bottom: 2px;">
                                            <div class="ui grid"
                                                style="padding-left: 10px;height: 100%;    padding-bottom: 10px;">
                                                <div class="seven wide column"
                                                    style="padding-left: 2px;padding-right: 2px;">
                                                    <textarea type="text" id="key_public_key" name="key_public_key"
                                                        class="alg_input textarea"
                                                        style="height: 94%; border: solid 1px black;font-size: 0.8em; "
                                                        placeholder="PUBLIC KEY" spellcheck="false" rows="2"></textarea>
                                                </div>
                                                <div class="one wide column"
                                                    style="padding: 30px 0px 0px 0px; width: 2px !important;">
                                                    <span style="font-size: 20px;">,</span>
                                                </div>
                                                <div class="seven wide column"
                                                    style="padding-left: 4px;padding-right: 0px;">
                                                    <textarea type="text" id="key_private_key" name="key_private_key"
                                                        class="alg_input textarea"
                                                        style="height: 94%; border: solid 1px black; font-size: 0.8em;"
                                                        placeholder="PRIVATE KEY" spellcheck="false"
                                                        rows="2"></textarea>
                                                </div>
                                                <div class="one wide column" style="padding-top: 30px;">
                                                    <span style="font-size: 20px;">)</span>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>

                </div>

            </form>

        </div>

    </div>

    </div>

    <!-- keys dialogs -->
    <div id="generate_keys_dlg" class="ui fullscreen modal" style="min-height: 300px;">
        <i class="close icon"></i>

        <div class="ui header">Generate key pair</div>
        <div class="content" style="overflow: scroll;height: 80vh;">
            <form class="ui tiny form controls" id="generate_keys_dlg_form">
                <div class="field" style="height: 30px;">
                    <select id="generate_keys_dlg_algorithm" name="generate_keys_dlg_algorithm"
                        class="ui small fluid scrolling dropdown algorithm-select-keys-dlg" style="z-index: 2;">
                        <option value="">Select algorithm</option>
                        <option value="RS256" data-value="RSASHA256">RS256
                        </option>
                        <option value="RS384" data-value="RSASHA384">RS384
                        </option>
                        <option value="RS512" data-value="RSASHA512">RS512
                        </option>
                        <option value="ES256" data-value="ECDSASHA256">ES256
                        </option>
                        <option value="ES384" data-value="ECDSASHA384">ES384
                        </option>
                        <option value="ES512" data-value="ECDSASHA512">ES512
                        </option>
                        <option value="PS256" data-value="RSAPSSSHA256">PS256
                        </option>
                        <option value="PS384" data-value="RSAPSSSHA384">PS384
                        </option>
                        <option value="PS512" data-value="RSAPSSSHA512">PS512
                        </option>
                    </select>
                </div>

                <div >
                    <div class="ui pointing secondary menu keys_format" style="margin-left: -1px;">
                        <a class="active item" data-tab="pem">PEM</a>
                        <a class="item" data-tab="jwk">JWK</a>
                    </div>
                    <div class="ui  tab segment keys_format" data-tab="pem">
                        <div class="ui grid">
                            <div class="ui row">
                                <div class="eight wide column">
                                    <textarea id="dlg_publicKey_pem" name="dlg_publicKey_pem" class="ui medium input"
                                        placeholder="PUBLIC KEY" spellcheck="false"
                                        style="min-height: 240px;"></textarea>

                                </div>
                                <div class="eight wide column">
                                    <textarea id="dlg_privateKey_pem" name="dlg_privateKey_pem" class="ui medium input"
                                        placeholder="PRIVATE KEY" spellcheck="false"
                                        style="min-height: 240px;"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="ui tab segment keys_format" data-tab="jwk">
                        <div class="ui grid">
                            <div class="ui row">
                                <div class="eight wide column">
                                    <textarea id="dlg_publicKey_jwk" name="dlg_publicKey_jwk" class="ui medium input"
                                        placeholder="JWK PUBLIC KEY" spellcheck="false"
                                        style="min-height: 240px;"></textarea>

                                </div>
                                <div class="eight wide column">
                                    <textarea id="dlg_privateKey_jwk" name="dlg_privateKey_jwk" class="ui medium input"
                                        placeholder="JWK PRIVATE KEY" spellcheck="false"
                                        style="min-height: 240px;"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="sixteen wide column" style="text-align: center;">
                    <div class="ui secondary button" id="dlg_btn_key_generate" style="min-width: 120px;">
                        Generate
                    </div>
                    <div class="ui secondary button" id="dlg_btn_key_save" style="min-width: 120px;">
                        Save
                    </div>
                </div>
            </form>




        </div>
    </div>

    <!-- PEM <-> JWK -->
    <div id="pem_jwk_convertor_dlg" class="ui fullscreen modal" style="min-height: 300px;">
        <i class="close icon"></i>
        <div class="ui header">PEM &lt;--&gt; JWK convertor - <span id="dlg_key_alg"></div>
        <div class="content" style="overflow: scroll;height: 80vh;">
            <form class="ui tiny form controls" id="pem_jwk_convertor_form">
                <div class="ui bottom attached segment">
                    <div class="ui grid" style="padding: 5px;">
                        <div class="ui row">
                            <div class="sixteen wide column">
                                <div class="ui large secondary label" style="width: 100%;">Algorithm</div>
                                <select id="pem_jwk_convertor_algorithm" name="algorithm-select"
                                    class="ui small fluid scrolling dropdown algorithm-select" style="z-index: 2;">
                                    <option value="none" selected="">Select</option>
                                    <option value="HS256" data-value="HMACSHA256">HS256
                                    </option>
                                    <option value="HS384" data-value="HMACSHA384">HS384
                                    </option>
                                    <option value="HS512" data-value="HMACSHA512">HS512
                                    </option>
                                    <option value="RS256" data-value="RSASHA256">RS256
                                    </option>
                                    <option value="RS384" data-value="RSASHA384">RS384
                                    </option>
                                    <option value="RS512" data-value="RSASHA512">RS512
                                    </option>
                                    <option value="ES256" data-value="ECDSASHA256">ES256
                                    </option>
                                    <option value="ES384" data-value="ECDSASHA384">ES384
                                    </option>
                                    <option value="ES512" data-value="ECDSASHA512">ES512
                                    </option>
                                    <option value="PS256" data-value="RSAPSSSHA256">PS256
                                    </option>
                                    <option value="PS384" data-value="RSAPSSSHA384">PS384
                                    </option>
                                    <option value="PS512" data-value="RSAPSSSHA512">PS512
                                    </option>
                                </select>
                            </div>
                        </div>
                        <div class="ui row">
                            <div class="eight wide column">
                                <textarea id="pem_jwk_convertor_pem" name="pem_jwk_convertor_pem"
                                    class="ui medium input" placeholder="PEM" spellcheck="false"
                                    style="min-height: 300px;"></textarea>
                                <div class="ui right floated secondary button" id="pem_jwk_convertor_pem_btn"
                                    style="min-width: 120px;">
                                    PEM to JWK
                                </div>

                            </div>
                            <div class="eight wide column">
                                <textarea id="pem_jwk_convertor_jwk" name="pem_jwk_convertor_jwk"
                                    class="ui medium input" placeholder="JWK" spellcheck="false"
                                    style="min-height: 300px;"></textarea>
                                <div class="ui secondary button" id="pem_jwk_convertor_jwk_btn"
                                    style="min-width: 120px;">
                                    JWK to PEM
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="ui row">

                </div>
            </form>
        </div>
    </div>


    <!-- attacks dialogs -->
    <div id="generate_attacks_dlg" class="ui fullscreen modal" style="min-height: 300px;">
        <i class="close icon"></i>
        <div class="ui header">Key confusion attack:</div>
        <div class="content" style="overflow: scroll;">
            The following conditions need to be met (see <a
                href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/06-Session_Management_Testing/10-Testing_JSON_Web_Tokens"
                target="_blank">OWASP - Testing_JSON_Web_Tokens</a>):
            <ul>
                <li>The application must expect the JWT to be signed with a public key based algorithm (i.e, RSxxx or
                    ESxxx)</li>
                <li>The application must not check which algorithm the JWT is actually using for the signature</li>
                <li>The public key used to verify the JWT must be available to the attacker</li>
            </ul>
            <div>Generated tokens:</div>
            <div class="ui padded height grid">
                <div class="twelve wide column" style="padding:0px 1px 1px 1px;">
                    <table id="tbl_attack_tokens" class="ui celled table small responsive nowrap unstackable"
                        style="overflow: scroll;">
                        <thead>
                            <tr>
                                <th style="width: 40px;"></th>
                                <th>Token</th>
                            </tr>
                        </thead>
                    </table>
                </div>
                <div class="four wide column" style="padding:0px 1px 1px 1px;">
                    <textarea id="dlg_publicKey_key_confusion" name="dlg_publicKey_key_confusion"
                        class="ui medium input" placeholder="PUBLIC KEY" spellcheck="false"
                        style="min-height: 300px;"></textarea>
                </div>
                <div class="sixteen wide column" style="padding:0px 1px 1px 1px;">
                    <div class="ui secondary button" id="dlg_btn_key_generate" style="min-width: 120px;">
                        Generate
                    </div>
                </div>

            </div>

        </div>
    </div>

    </div>

    <div class="ui mini modal">
        <div class="header">Operation error</div>
        <div class="content">
            <span id="traffic_error_message"></span>
        </div>
        <div class="actions">
            <div class="ui approve button">Close</div>
        </div>
    </div>
</body>

</html>