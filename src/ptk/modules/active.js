/* Author: Denis Podgurskii */

export class ptk_module_active {

    constructor() {
        this.moduleType = 'active'
    }

    prepareAttack(schema, attack, random) {
        return { schema, attack }
    }

    validateAttack(item, vulnRegex, originalRequest) {
        if (vulnRegex) {
            let re = new RegExp(vulnRegex)
            let body = atob(item.body)
            if (re.test(body)) {
                item.success = true
                item.proof = btoa(body.match(re)[0])
                console.log("match found")
            } else {
                item.success = false
                item.proof = ""
                console.log("match NOT found")
            }
        }
        return item
    }
}